# 第3章：Excel×Pythonで「目に見える成果」を出す

## この章で作るもの

```
┌─────────────────────────────────────────────────────────────┐
│  第3章の成果物                                              │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  🎯 成果物1: 100枚のExcelを3秒で統合するツール              │
│     ・フォルダに入れてダブルクリック                        │
│     ・100ファイルが1つに統合される                          │
│     ・GASなら6分タイムアウト → Pythonなら3秒               │
│                                                              │
│  🎯 成果物2: グラフ付き売上レポート自動生成                 │
│     ・売上データを読み込む                                   │
│     ・部門別・月別の集計                                     │
│     ・グラフ付きExcelレポートを自動出力                     │
│                                                              │
│  🎯 成果物3: exe化して配布                                   │
│     ・Pythonを知らない人でも使える                          │
│     ・経理部にダブルクリック実行ツールを配布               │
│     ・（exe化は第4章で詳細解説）                            │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## この章の流れ

| 節 | 内容 | 作れるもの |
|----|------|------------|
| 3-1 | openpyxl入門 | Excelファイルの読み書き |
| 3-2 | pandas入門 | データ分析の基礎 |
| 3-3 | GASの6分制限を超える | 大量データ処理 |
| 3-4 | 売上レポート自動生成 | **グラフ付きExcelレポート** |
| 3-5 | 100枚Excel統合ツール | **3秒で100ファイル統合** |
| 3-6 | AIプロンプト集 | 困ったときの質問テンプレート |

---

## 完成イメージ

### 成果物1: 100枚Excel統合ツール

**Before:**
```
月次売上フォルダ/
├── sales_2024_01.xlsx    (150行)
├── sales_2024_02.xlsx    (180行)
├── sales_2024_03.xlsx    (200行)
│   ...
└── sales_2024_12.xlsx    (190行)

→ 合計12ファイル、約2000行
→ 手作業なら1時間以上
→ GASなら6分タイムアウトの可能性
```

**After (Python実行後):**
```
統合完了！
処理時間: 2.8秒
処理ファイル数: 12
合計行数: 2,156行
出力ファイル: 年間売上_統合.xlsx
```

### 成果物2: グラフ付き売上レポート

**出力されるExcel:**
```
┌─────────────────────────────────────────┐
│  Sheet1: 月別売上推移                   │
│  ┌─────────────────────────────────┐   │
│  │     📊 棒グラフ                  │   │
│  │     1月: ████████ 150万         │   │
│  │     2月: ██████████ 180万       │   │
│  │     3月: ████████████ 200万     │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│  Sheet2: 部門別売上                     │
│  営業部: 45%  開発部: 35%  総務部: 20% │
├─────────────────────────────────────────┤
│  Sheet3: 詳細データ                     │
│  [元データがそのまま保存]               │
└─────────────────────────────────────────┘
```

---

## 事前準備

この章を始める前に確認してください：

```
✓ Google Colabにアクセスできる
✓ 第1章・第2章を完了している（推奨）
✓ Excelファイルを扱う業務がある（動機があると学習効率UP）
```

**サンプルデータについて:**
各節で、サンプルデータを自動生成するコードを用意しています。
手元にExcelファイルがなくても、すべての演習を実行できます。

---

## GAS経験者へ

```
┌─────────────────────────────────────────────────────────────┐
│  GAS vs Python: Excel処理の違い                             │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  GAS:                                                        │
│  ・スプレッドシート（Google製）が得意                       │
│  ・Excelファイルは変換が必要                                │
│  ・6分のタイムアウト制限                                    │
│  ・大量ファイル処理は苦手                                   │
│                                                              │
│  Python:                                                     │
│  ・Excelファイル（.xlsx）を直接操作                         │
│  ・タイムアウトなし                                         │
│  ・100ファイルでも数秒で処理                                │
│  ・グラフ・書式設定も自動化可能                            │
│                                                              │
│  この章を終えると:                                           │
│  「GASでやっていたExcel処理をPythonでもっと速く」           │
│  が実現できます。                                            │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**それでは、3-1 openpyxl入門から始めましょう！**
