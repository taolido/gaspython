# 4-1. なぜローカル環境が必要になるのか

## この節で学ぶこと

- Colabの限界を理解する
- ローカル環境が必要なケースを具体的に知る
- 移行のタイミングを判断できるようになる

---

## Colabで「できないこと」

第1〜3章ではColabを使ってきました。Colabは素晴らしい環境ですが、**できないこと**もあります。

```
┌─────────────────────────────────────────────────────────────┐
│  Colabでは「できない」こと                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ✗ exe化して配布する                                        │
│    → 「ダブルクリックで実行」の形で配布できない            │
│                                                              │
│  ✗ 完全な定期実行                                           │
│    → セッションが切れると実行が止まる                      │
│                                                              │
│  ✗ ローカルファイルへの直接アクセス                        │
│    → 毎回アップロードが必要                                │
│                                                              │
│  ✗ 機密データの安全な処理                                   │
│    → Googleのサーバーを経由してしまう                      │
│                                                              │
│  ✗ オフライン作業                                           │
│    → インターネット接続が必須                              │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## ケース1: exe化して配布したい

```
┌─────────────────────────────────────────────────────────────┐
│  シナリオ                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  「第3章で作った売上集計ツールを、                          │
│   経理部の山田さんにも使ってもらいたい。                    │
│   でも山田さんはPythonを知らないし、                        │
│   Colabの使い方も分からない...」                            │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  解決策                                                      │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Pythonスクリプトを exe（実行ファイル）に変換する           │
│                                                              │
│  売上集計.py → 売上集計.exe                                 │
│                                                              │
│  山田さんは:                                                 │
│  1. exeファイルをダブルクリック                             │
│  2. Excelファイルを選択                                      │
│  3. 集計結果が自動生成される                                │
│                                                              │
│  → Pythonのインストール不要！                              │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**Colabではexe化できません。ローカル環境が必要です。**

---

## ケース2: 定期実行したい

```
┌─────────────────────────────────────────────────────────────┐
│  シナリオ                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  「毎朝9時に売上データを集計して、                          │
│   結果をメールで自動送信したい。                            │
│   GASならトリガーで簡単にできたのに...」                    │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  Colabの問題                                                 │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ・セッションが約12時間で切れる                             │
│  ・アイドル状態だと90分でタイムアウト                       │
│  ・自動でセッションを開始する方法がない                     │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  解決策                                                      │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ローカルPCで「タスクスケジューラー」を使う                 │
│                                                              │
│  設定:                                                       │
│  ・毎日9:00に「売上集計.py」を実行                          │
│  ・実行結果をログファイルに保存                             │
│  ・PCが起動していれば確実に実行される                       │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**Colabでは完全な定期実行ができません。**

---

## ケース3: 大量のローカルファイルを処理したい

```
┌─────────────────────────────────────────────────────────────┐
│  シナリオ                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  「フォルダ内に100個のExcelファイルがある。                 │
│   これを全部処理したい。」                                  │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  Colabの場合                                                 │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. 100個のファイルをZIP化                                  │
│  2. Colabにアップロード                                      │
│  3. 解凍して処理                                             │
│  4. 結果をダウンロード                                       │
│                                                              │
│  → 面倒。毎回アップロードが必要。                          │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  ローカルの場合                                              │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  import glob                                                 │
│  files = glob.glob('C:/売上データ/*.xlsx')                  │
│  for f in files:                                             │
│      process(f)                                              │
│                                                              │
│  → 直接アクセス。アップロード不要。                        │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## ケース4: 機密データを扱いたい

```
┌─────────────────────────────────────────────────────────────┐
│  シナリオ                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  「個人情報が含まれる顧客データをPythonで処理したい。       │
│   でも、Colabだとデータがネットワーク上を流れる...」        │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  セキュリティ上の考慮                                        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Colabを使うと:                                              │
│  ・データがGoogleのサーバーにアップロードされる            │
│  ・処理もGoogleのサーバーで行われる                        │
│  ・会社のセキュリティポリシーに違反する可能性              │
│                                                              │
│  ローカル環境なら:                                           │
│  ・データは自分のPC内で完結                                 │
│  ・ネットワークに出ない                                     │
│  ・セキュリティポリシーをクリア                             │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## ケース5: オフラインで作業したい

```
┌─────────────────────────────────────────────────────────────┐
│  シナリオ                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ・新幹線の中で作業したい                                   │
│  ・客先でネットが使えない                                   │
│  ・社内ネットワークからGoogleにアクセスできない            │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  解決策                                                      │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ローカルにPythonがあれば、ネットなしで動作                 │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 移行のタイミング

```
┌─────────────────────────────────────────────────────────────┐
│  今すぐローカル環境が必要？                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  以下に当てはまるなら → YES                                 │
│                                                              │
│  □ 作ったツールを他の人に配布したい                        │
│  □ 毎日自動で処理を実行したい                              │
│  □ 100個以上のファイルを処理する                           │
│  □ 機密データを扱う必要がある                              │
│  □ オフラインで作業したい                                  │
│                                                              │
│  当てはまらないなら → Colabで十分                          │
│                                                              │
│  ただし、この章を読んでおくことをおすすめします。           │
│  いつか必要になったときに、すぐに対応できます。             │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## この節のまとめ

- Colabでは「exe化」「定期実行」「ローカルファイル直接アクセス」「機密データ処理」「オフライン作業」ができない
- これらが必要になったとき、ローカル環境への移行が必要
- 今すぐ必要なくても、この章で「壊さない」作法を学んでおくことをおすすめ

**次の節では、ローカル環境を「壊さない」ための鉄則を学びます。これを知らずにローカル環境を使うと、いつか必ず壊れます。**
