# 5-1. いつGASを使い、いつPythonを使うか

## この節で学ぶこと

- GASとPythonの強み・弱みを理解する
- 使い分けの判断基準を身につける
- 両方を組み合わせる選択肢を知る

---

## GASとPythonの比較表

```
┌─────────────────────────────────────────────────────────────┐
│  GAS vs Python 比較                                         │
├───────────────────┬──────────────────┬──────────────────────┤
│  項目              │  GAS             │  Python              │
├───────────────────┼──────────────────┼──────────────────────┤
│  実行環境          │  Googleサーバー  │  ローカルPC          │
│  セットアップ      │  不要            │  必要                │
│  処理時間制限      │  6分             │  なし                │
│  Googleサービス連携│  非常に簡単      │  要設定              │
│  ローカルファイル  │  不可            │  直接アクセス可      │
│  データ処理能力    │  限定的          │  pandas等で強力      │
│  配布方法          │  URL共有         │  exe化               │
│  定期実行          │  トリガー(簡単)  │  タスクスケジューラ  │
│  オフライン実行    │  不可            │  可能                │
│  機械学習          │  不可            │  可能                │
└───────────────────┴──────────────────┴──────────────────────┘
```

---

## GASの強み

### 1. Googleサービスとの親和性

```javascript
// GAS: Gmail送信が3行
function sendEmail() {
  GmailApp.sendEmail("test@example.com", "件名", "本文");
}
```

```python
# Python: Gmail送信は認証設定が必要
import smtplib
from email.mime.text import MIMEText

# 認証情報の設定...
# SMTPサーバーへの接続...
# メール作成...
# 送信...
# 約30行
```

**GASの圧倒的優位**
- スプレッドシート、ドキュメント、Gmail、カレンダー
- 認証不要で即座にアクセス
- 公式サポートによる安定性

### 2. トリガーによる定期実行

```javascript
// GAS: ワンクリックで設定
// エディタ → トリガー → トリガーを追加
// 「毎日9時に実行」を選ぶだけ
```

```python
# Python: タスクスケジューラを設定
# Windows: タスクスケジューラでpythonw.exeを登録
# Mac: crontabを編集
# 設定が複雑
```

### 3. URL共有の容易さ

```
GAS:
1. ウェブアプリとしてデプロイ
2. URLを共有
3. 相手はブラウザでアクセスするだけ

Python:
1. exe化
2. ファイルを渡す
3. 相手のPCでセキュリティ警告が出る可能性
```

---

## Pythonの強み

### 1. データ処理能力

```python
# Python: 100万行のCSVを数秒で処理
import pandas as pd

df = pd.read_csv('huge_data.csv')  # 100万行
result = df.groupby('部署')['売上'].sum()  # 一瞬
print(result)
```

```javascript
// GAS: 100万行は処理できない
// スプレッドシートの行数制限（約100万行）
// 6分のタイムアウト
// メモリ制限
```

### 2. ローカルファイルへの直接アクセス

```python
# Python: フォルダ内の全Excelを一括処理
import glob
import pandas as pd

files = glob.glob('C:/売上データ/**/*.xlsx', recursive=True)
for f in files:
    df = pd.read_excel(f)
    # 処理...
```

```javascript
// GAS: ローカルファイルにはアクセスできない
// Googleドライブにアップロードが必要
```

### 3. exe化による配布

```
Python:
・非エンジニアにexeを渡す
・ダブルクリックで実行
・Pythonのインストール不要
・Googleアカウント不要

GAS:
・非エンジニアにURLを共有
・ただしGoogleアカウントが必要
・社外配布は権限設定が複雑
```

### 4. 機械学習・高度なデータ分析

```python
# Python: 機械学習ライブラリが充実
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestClassifier
import tensorflow as tf
import torch
```

```javascript
// GAS: 機械学習ライブラリはない
// 統計処理も限定的
```

---

## 使い分け判断フローチャート

```
┌─────────────────────────────────────────────────────────────┐
│  質問1: 何を主に操作する？                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────────┐                                        │
│  │ Google Workspace │                                        │
│  │ (スプレッドシート│    → GAS推奨                          │
│  │  Gmail、ドキュメント)                                     │
│  └─────────────────┘                                        │
│                                                              │
│  ┌─────────────────┐                                        │
│  │ ローカルファイル │    → Python推奨                       │
│  │ (Excel、CSV)     │                                        │
│  └─────────────────┘                                        │
│                                                              │
│  ┌─────────────────┐                                        │
│  │ 両方             │    → 質問2へ                          │
│  └─────────────────┘                                        │
│                                                              │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  質問2: データ量・処理の複雑さは？                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────────┐                                        │
│  │ 少量・単純       │    → GAS推奨                          │
│  │ (数千行以下)     │                                        │
│  └─────────────────┘                                        │
│                                                              │
│  ┌─────────────────┐                                        │
│  │ 大量・複雑       │    → Python推奨                       │
│  │ (数万行以上)     │      またはPython→スプレッドシート   │
│  └─────────────────┘                                        │
│                                                              │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  質問3: 誰が使う？                                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────────┐                                        │
│  │ 自分だけ         │    → どちらでもOK                     │
│  └─────────────────┘                                        │
│                                                              │
│  ┌─────────────────┐                                        │
│  │ 社内             │    → GAS推奨（共有が簡単）            │
│  │ (Google Workspace使用)                                    │
│  └─────────────────┘                                        │
│                                                              │
│  ┌─────────────────┐                                        │
│  │ 社外             │    → Python推奨（exe化）              │
│  │ (Googleアカウントなし)                                    │
│  └─────────────────┘                                        │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 具体的なケース判定

### ケース1: 営業日報の自動集計

```
状況:
・毎日、Googleフォームで営業日報を提出
・スプレッドシートに蓄積
・週次でサマリーをメール送信

→ GAS推奨

理由:
・Googleフォーム → スプレッドシート → Gmailの連携
・GASならトリガーで自動実行
・認証設定不要
```

### ケース2: 経理部への売上レポート配布

```
状況:
・ローカルのExcelファイルを集計
・PDFレポートを作成
・経理部（Pythonを知らない）に配布

→ Python推奨

理由:
・ローカルExcelへの直接アクセス
・exe化して「ダブルクリックで実行」
・相手はPythonもGoogleアカウントも不要
```

### ケース3: 顧客データの分析

```
状況:
・10万件の顧客データを分析
・購買傾向を可視化
・機械学習で予測モデルを作成

→ Python推奨

理由:
・大量データの高速処理（pandas）
・可視化ライブラリ（matplotlib、seaborn）
・機械学習ライブラリ（scikit-learn）
・GASでは不可能
```

### ケース4: 社内チームへの共有ツール

```
状況:
・チームメンバー10人で使うツール
・全員Googleアカウントあり
・スプレッドシートでデータ管理

→ GAS推奨

理由:
・URLを共有するだけ
・更新が即座に反映
・権限管理が容易
```

### ケース5: 外部クライアントへのレポート作成

```
状況:
・毎月、クライアントに分析レポートを納品
・複数のExcelファイルを集計
・レポートの自動生成

→ Python推奨

理由:
・ローカルファイル処理
・exe化して社内で使用
・クライアントにはPDFやExcelで納品
```

---

## 両方を組み合わせるパターン

### パターンA: Python → スプレッドシート

```
処理フロー:
1. Pythonで大量データを処理
2. 結果をスプレッドシートに書き込み
3. GASで通知やトリガー実行

使用技術:
・gspread（5-2で解説）
```

### パターンB: スプレッドシート → Python → スプレッドシート

```
処理フロー:
1. スプレッドシートからデータ取得
2. Pythonで複雑な処理（機械学習など）
3. 結果をスプレッドシートに書き戻し

使用技術:
・gspread（5-2で解説）
```

### パターンC: Python → GAS（WebAPI経由）

```
処理フロー:
1. Pythonで処理
2. GASのWebAPIにデータ送信
3. GASで後続処理（メール送信など）

使用技術:
・GAS doPost関数（5-3で解説）
```

---

## 判断に迷ったときのガイド

```
┌─────────────────────────────────────────────────────────────┐
│  迷ったときの考え方                                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  「Google Workspaceの中で完結する？」                       │
│    → Yes: GAS                                               │
│    → No: Python                                             │
│                                                              │
│  「6分以内に終わる？」                                       │
│    → Yes: GASでも可能                                       │
│    → No: Python                                             │
│                                                              │
│  「Googleアカウントを持っていない人が使う？」               │
│    → Yes: Python（exe化）                                   │
│    → No: GASでも可能                                        │
│                                                              │
│  「機械学習や高度な分析が必要？」                           │
│    → Yes: Python                                            │
│    → No: どちらでもOK                                       │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 最終的には「どちらが楽か」

```
GASが楽なケース:
・Googleサービス連携が多い
・URLで共有したい
・トリガーで自動実行したい

Pythonが楽なケース:
・ローカルファイルを扱う
・大量データを処理する
・exe化して配布したい
```

---

## この節のまとめ

- GASはGoogleサービス連携・共有・トリガーが強い
- Pythonはデータ処理能力・ローカル操作・exe化が強い
- 判断基準：何を操作する？データ量は？誰が使う？
- 両方を組み合わせることも可能（次節で解説）
- 迷ったら「どちらが楽か」で選ぶ

**次の節では、PythonからGoogleスプレッドシートを直接操作する方法（gspread）を学びます。**
